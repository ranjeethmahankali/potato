
#include <Position.h>
#include <iostream>

namespace potato {

void generateZobristHashTable()
{
  std::array<size_t, 18 * 64> rand;
  for (size_t pc = 0; pc < 18; ++pc) {
    for (size_t pos = 0; pos < 64; ++pos) {
      rand[pc * 64 + pos] = size_t(std::rand()) | (size_t(std::rand()) << 32);
    }
  }
  std::cout << "static constexpr std::array<size_t, " << rand.size()
            << "> sZobristTable = {{";
  std::cout << rand[0];
  for (size_t i = 1; i < rand.size(); ++i) {
    std::cout << ", " << rand[i];
  }
  std::cout << "}}\n";
}

static size_t pieceIndex(uint8_t pc)
{
  switch (pc) {
  // White
  case Piece::WHT | Piece::PWN:
    return 0;
  case Piece::WHT | Piece::HRS:
    return 1;
  case Piece::WHT | Piece::BSH:
    return 2;
  case Piece::WHT | Piece::ROK:
    return 3;
  case Piece::WHT | Piece::QEN:
    return 4;
  case Piece::WHT | Piece::KNG:
    return 5;
  // Black
  case Piece::BLK | Piece::PWN:
    return 6;
  case Piece::BLK | Piece::HRS:
    return 7;
  case Piece::BLK | Piece::BSH:
    return 8;
  case Piece::BLK | Piece::ROK:
    return 9;
  case Piece::BLK | Piece::QEN:
    return 10;
  case Piece::BLK | Piece::KNG:
    return 11;
    // Flags
  case Piece::WHT | Piece::PWN | Piece::ENPASSANT:
    return 12;
  case Piece::WHT | Piece::ROK | Piece::CASTLE:
    return 13;
  case Piece::WHT | Piece::KNG | Piece::CASTLE:
    return 14;
  case Piece::BLK | Piece::PWN | Piece::ENPASSANT:
    return 15;
  case Piece::BLK | Piece::ROK | Piece::CASTLE:
    return 16;
  case Piece::BLK | Piece::KNG | Piece::CASTLE:
    return 17;
  default:
    return SIZE_MAX;
  }
}

size_t Position::zobristHash() const
{
  static constexpr std::array<size_t, 1152> sZobristTable = {
    {3637540459146593639, 7364309476121024617, 1822089776492239953, 7085667360092755018,
     5109470997758484265, 5800310500564359354, 4735287597372359154, 8450407968639461859,
     6615896439335616636, 5598299758207699028, 2240235047340090139, 7417221384466648551,
     3698059312838348662, 1003584061779540270, 2013064638502847027, 7739444318744069321,
     2730409744738745190, 4835695807260479501, 8972265950320376369, 7114519017560289443,
     7101201746112569637, 8222907814687453445, 3250854463413659736, 8476523078885803102,
     8755996796820241835, 793725101485052109,  6117188690220054171, 3217969343240545364,
     184680029042951182,  581956391574829172,  8952519704484771105, 7848349765195238876,
     4978410431474440816, 7012056933599725630, 6158664661804433985, 362297221456834044,
     8594661397722595902, 6649611679839864446, 6811776745761651178, 3265522692323464043,
     1530841485254842255, 8117261321622607964, 3046822245052924652, 8239906143826007099,
     6333412028733495858, 5429246943789157692, 7919891211012442604, 8522117110879715291,
     7514898205583079682, 8402233952719632638, 1990633891517579515, 8486685203742449322,
     8126364173465978363, 3984067078814363089, 2592315525301202949, 2835798355540162428,
     2085465523796600181, 2547815149176165822, 3841546264021404809, 8363790042945400668,
     1162839756840941224, 7014145954411099663, 8623889622009403313, 3534288538778199281,
     3400321001353412101, 2142234580120701943, 2254309591964746985, 6752878145256391226,
     7318472587293462474, 6872070613096286923, 8763162954058838344, 4810573090590902116,
     2214184572089668127, 6757544211997671198, 8922737500209432348, 7007317094158681444,
     1244255131113302804, 721564149046722138,  1887609999001301342, 7560188502710670201,
     6969003146762944827, 1455513856370929252, 1884598795132455441, 1157242432596349193,
     498593151988523178,  667115427753482668,  8513809973179342363, 1663640512340732079,
     3612704719109193267, 7560353348820274915, 5095774905571923528, 4174275400511963925,
     919017376689442747,  6984802755100640290, 9151692241678574778, 8094558378192941181,
     5800670273375581963, 6897264049164692506, 8535092203631382399, 7664968414079179512,
     6860447488451418360, 9072069424812491291, 4586400319027303861, 7655507935337703246,
     710150587782075032,  2287803185893054776, 2113415612277639801, 2922583495331932733,
     2134546103403896252, 5839060364657826638, 6005633438829299194, 8960189657666955372,
     5036946905852570284, 1044828702708399649, 5465216117030621610, 4158980395689273941,
     7818508919617981886, 29804956548473269,   5520015681797953339, 2157270209514682204,
     4454430104482086710, 2812719721784283827, 1683779944957979874, 376906668872033252,
     6419317434988981071, 5881192354442087701, 1702841704818559741, 5784510510166126158,
     3028719610523847176, 1865083648593014740, 6315764292807329162, 2372855255031989844,
     808369788927018650,  8092438381656012476, 864601073054314766,  3335179699155257256,
     5471409945428688556, 2663504857441352179, 2659830603348465484, 1750143901893768749,
     33006525135953161,   3057354836298691557, 4025974194735347908, 8475636842773126575,
     6447832522484567715, 6325257491663920767, 7141412496646170541, 8451125954007656310,
     1877400927864048862, 5054795717295901724, 8346528848829844554, 8061033174159797808,
     5314502798388440608, 2526384615230617221, 4541577525354726907, 7830109403219576839,
     2684492738752950260, 6310432278297709323, 1282585512273534496, 4541788704040201094,
     6680045534432458302, 2047270774192963825, 1118414875132931801, 3324496238647299123,
     8595216990154737305, 5737817799620376995, 7545895333392100372, 3089568524826271193,
     6076644929524289527, 2387987464102862752, 669109622473982224,  5969434466367437046,
     2658817033131156372, 840697260007938494,  8619191789878947004, 2448448543308017272,
     7026160129339936585, 1450579244825706726, 5770744010994309072, 1917018766320105946,
     3930995404708914538, 3637590727421817164, 3006943459568655185, 5890544796172004275,
     3119740357597684612, 1255066772409893178, 49885053887755003,   7142452343446082969,
     1057623907585441330, 6650104634571085892, 4142263530647385243, 6529308950213725673,
     4370900458525308453, 866254588603154952,  3531591637362695145, 6060861392664144990,
     1214737879714000736, 492733706463072978,  7202239339774242000, 4081897697963275770,
     5438438726055168472, 4887457640588817640, 3338093672295723366, 8197025864814351204,
     1566315509484403161, 4849161242638260871, 5498939607849955941, 7653630665411818074,
     911614307739416383,  1564740464332813952, 2079786572083458116, 2682420954613912700,
     8100681940228145289, 7516205795375082071, 335061124709803475,  7178156903664762285,
     7711695922561783686, 2038451591705635968, 5648780450283961623, 6222135137883895941,
     6635863888638323596, 3700302965192861030, 4003022495369624444, 3557899484859025020,
     1427074817352551458, 134470711356376548,  3524869769334022106, 6801385841233468427,
     5992046322752307631, 8481728918002486716, 7468951054089873076, 2877235263519790895,
     55384253209017855,   7783692497799612199, 5927792281333089171, 3695888624259084807,
     6630379940348629688, 6251715588455173393, 303381152789524269,  6324667199825035503,
     5708882985651261577, 5237317357430601654, 52657540296925493,   2412560388690415815,
     7909550763710552612, 3148439280099019367, 8107431052503116269, 2889032688182722322,
     1717989364136944965, 4643607968055370498, 6231808750103774693, 1762693737436927992,
     6512316151354076279, 5048847054608590545, 8600652362351523990, 8546153272138192628,
     8609280130907745941, 5096544027131033986, 7375429756670796396, 5483269505989063342,
     9180021687807060173, 2993366231912414568, 5434011290704633516, 7003523972312758950,
     7331752064927728308, 5574410261309353162, 1539884461120516786, 7979005431774355767,
     6128141287783606731, 5644525877615934159, 5954622662812053449, 1368212883278621568,
     304033670906077294,  4779096397657370152, 4750489291523813196, 4517699872101187434,
     447330611729997293,  3547847604781755091, 4170092982958995788, 3809970518273949835,
     3751759443753091874, 6618661787061191834, 7498112747917259288, 4120472482640909566,
     9178775627213975001, 684931573124185669,  5508933438448902545, 2027184977476467713,
     8517901368959946441, 4269058495782110425, 7845275237630528257, 8752157561810114095,
     7074452437189607701, 4950575710645413255, 4404632667829347964, 4299646398620743266,
     8921554980237824873, 4224663977453789042, 7069231332955414733, 2375805648996655461,
     8886762785644250174, 3711289139631090761, 5113881680671132017, 1761919255443613646,
     3321383453239136885, 8453429632110319183, 5594364082254246122, 1012520464373155428,
     1835476243505524097, 5466617870177872993, 5500270373525606910, 5173128983915052443,
     2237828376476032447, 3171376964911737577, 8519557386756247934, 7108322595891285298,
     8607919838176717817, 4131900281634356108, 7334713817922642375, 8906840490474409380,
     2701425251448918018, 3376011890469376434, 6895741201645867122, 2517861781584949996,
     1128256493006324737, 5747954321778971120, 8527371879411696144, 2603608140143360871,
     1872132195500797081, 1625515891609624155, 2098795684256199327, 127893648388182996,
     1106706149313733898, 5981772963276248067, 930241432393216700,  650773162541120269,
     4578767461476091291, 2704083982838006699, 8415317405705544917, 1758982030268830721,
     3983053379331003877, 6948728728389025494, 9204647620887049597, 4828881440920876997,
     6103949938880192654, 3021725329230307374, 5964863785324118447, 462717069712273862,
     7409412911935996771, 6289617862871969162, 2886359410882144112, 2747948991316572382,
     1743804041568810326, 492891457475674906,  1450606697427792673, 1255951272276673281,
     535437802937531661,  8720713302941688061, 8533644828048342038, 2370121164355392673,
     1557248004830998243, 4393596316355375058, 8541465475499157714, 5370309687938193227,
     2077431380053911393, 5843788651612365397, 153574506808667500,  3205545622144547805,
     4820398575933773756, 2833127958797057261, 5950310567364728339, 2481293317560554469,
     3070387192737169863, 7002461752977098155, 6304857290655255972, 7794882716151978625,
     5541057376210898716, 6160845048786595098, 7821420383867710443, 2363285122138432548,
     4744338218120366395, 5639270518002901534, 7575439381972443564, 6795291271159028074,
     3319881180765412595, 220099164000683078,  4494126419880072775, 6532568077282657830,
     4680027067356187917, 721801561840686571,  4460868671735211551, 400245577640662842,
     2258419234642983616, 5637704825946615082, 8868873330592237754, 1531947310870247928,
     6984691691423520711, 64380199932086430,   6792661925723372049, 8509224959740113627,
     7264718662044940384, 935990778761890314,  2207344570594742093, 876614625127671477,
     2556844610447268867, 8648883954812630797, 891728425958763789,  7796267299716265821,
     6386848122025775771, 4006615244405149304, 2988218000038376917, 1198816890766290252,
     3486408340851319942, 6086296691148310287, 8122868559642007538, 1944869301501408668,
     4878101703067152653, 8699688229902409466, 1126046899453071320, 4749445870463081653,
     1951347000848695888, 1477232755228044797, 4000715281871970825, 5993223087409207082,
     4260728104750156258, 7196540784953692155, 6315028848087494163, 7998483761543138644,
     435182729563583281,  1633763379656470834, 1010185990868061774, 5498894437182987126,
     6459492761421178485, 3750361926447366070, 5328141450553409569, 2045059129624846888,
     3451393548476608558, 899191841354789327,  3572419902942426496, 8616300203834001116,
     7668881223723576988, 5858722077773823769, 5761454592945607710, 5338603182745366346,
     271870177149116625,  5531316579154973299, 1327627206704940874, 7170343859804909179,
     6782049616156256346, 6149287587850626061, 973769511600655004,  942935444402219757,
     2493266569768556123, 2653899853571067138, 8734542216668489141, 4675462443548789565,
     8636296974630693558, 2717217399491326210, 5944646282635056836, 2147644818523424292,
     5804815114226204872, 7498572623506384565, 262428344601773696,  5696190254349972946,
     7142878198001501025, 707924947315693398,  1593080488114003990, 3318438728529676488,
     3492987681769889535, 928661493738766925,  8019166604798519720, 960837228266117383,
     6914936419607910369, 3383099036441187123, 2510503179581811285, 629355084022621755,
     3986333215788233198, 6224388575736902447, 4350100117130748448, 2069867477850810185,
     5319312598577922786, 1162881946729886591, 4428652823326867683, 1775368107719711081,
     1230287224800498193, 1702426325530616984, 8308153534451067201, 7458173335318679576,
     6341318187996628904, 412556541442650056,  7148644192017185954, 7943767620236713242,
     9169839328699310836, 6160366929193166590, 7641990952350939467, 6566173685105273494,
     1784654797503188200, 1426952561763753765, 2987004272387431004, 4911576084777069998,
     5906350266646975557, 4243373289932171303, 53893933692096485,   1767477642445209257,
     4096074925448649610, 6023661448117422474, 3221945807205647477, 3932952449414219452,
     465469151615940334,  7464980510172949631, 9100181746649103362, 2622019579038706791,
     3313465753403831595, 7874772128127571638, 7251292810285925403, 1294389486124415989,
     953606555945227947,  8925402806468875751, 8015937364452662363, 7402712607031082526,
     3649542598094652162, 4909987333657595921, 8947059049793089101, 816529476085640929,
     489515083674682503,  8296616270668617076, 3865920107827262070, 2027789305061493108,
     5744235953655008616, 4256483852315064104, 4242165574531638415, 7706427771459250660,
     1865264079788775225, 6203272617966707146, 8877966953132659804, 3546469662580681593,
     8585615204289259409, 952253891407994582,  8076024744602800727, 8498458381781826329,
     826921312602482968,  8931864628188944233, 43594387298472553,   2648855251248513839,
     2415471290582466824, 336615035479830868,  3232840409443249525, 2630036960883679441,
     6228129306862689029, 5755933894471202883, 3992550730138624644, 9186861743955560128,
     8535488520730353479, 2440724077945905139, 2684526961707447117, 6730309019901085821,
     64140999466363801,   8204289694739675123, 8175083503335948484, 5895565732013284819,
     8535112014844474746, 8024819628620195683, 5051851533282454113, 7642684872370005917,
     1041422092497226447, 7939333028578424007, 4254278250183541661, 8388766726651410280,
     8818566332040503581, 1731163925682721922, 3321929192762978919, 5791169531203104976,
     5676902522111769830, 3493805581141662723, 6401860098221417446, 5995796747804065654,
     6398180041645803775, 8258180461496581199, 6228728892218584845, 4283268343511333062,
     1629367987995984845, 3080751772644370224, 1678680036206897429, 226668935383870030,
     3852265230183544308, 3553595588285800093, 1195933774090591185, 1336892576173606493,
     4893480267427166258, 2278078245793044066, 4996697435762924599, 7785568402857440633,
     3847747298459303090, 4398164980774918294, 4274498083361314229, 8123255142833890716,
     2457290622666456810, 2564140276977017069, 4226781341064489830, 5409844985971012145,
     4748642077722446349, 6029868957339781558, 9084833654743457853, 3594040106865655445,
     2974087656121365108, 6826910214109656199, 4922621311548517072, 918918502025917410,
     2986111370756791241, 400100729123640129,  4775144770232311253, 3941103495063079681,
     1280618713726240171, 2145034010622379198, 72680945398724395,   4363074587036504683,
     7294947536142911422, 1542526831636981526, 8536333036739931189, 2687979002492665962,
     1785313254306560675, 1034461715331001685, 5680623764154834674, 6254931139008122101,
     7270463698010271151, 6703972552174955578, 5955015703234517268, 831299780989347907,
     7926947778128388906, 3519662430601744336, 1307840753497826289, 3597579709793508237,
     9052308520864792158, 6535825402522588075, 1053301445225834575, 1428946142049175869,
     291949552202991879,  323177228532697189,  4416788074737096649, 5415936410119709365,
     4009768200965289360, 5286116165132914941, 4318240933675664939, 7977046286453271908,
     9093749739881473602, 1798073365916582827, 932701660983713649,  557634705015518690,
     1312387580285805020, 9126907670038644834, 7093892475698584995, 5204303725044034845,
     3795889632613222449, 4135043305257143972, 2882217288557742812, 1453185399945684339,
     3224144608256933961, 7633397359015546641, 3633345478641053616, 1340830182174584778,
     8660408293109250475, 4681941633897308197, 8534556623801258669, 1131376064379401963,
     3109664405301190549, 2989261194891411124, 2367393468501348589, 8366026876341543907,
     4497673840952369491, 5152588767315147033, 3605305827560956897, 5048504582178368668,
     4121703699779622140, 5148463936600746655, 622229476098406435,  2035400318938684063,
     404825630011723230,  429003651738553066,  2733546252746559692, 339582388485461269,
     2595291413681226019, 6823395508635200922, 2299036470752509851, 1902595948589853486,
     20376456011105285,   4953229404360215838, 4437586848458539731, 1231760676092726289,
     4236891854022948200, 7090967689804061820, 3646146701056479514, 4918387062474235738,
     6620337924723962335, 3766982552321376133, 6907770423888292890, 5973722802958463758,
     7435408522036226148, 5242374685044801357, 316424581711114790,  7307783274081290479,
     4976783308389912259, 3962483321294282257, 3816002589123055560, 8750288674674288998,
     2351096581815640276, 3688643732117615291, 6520880299511545085, 824843574938063079,
     4731049465507413082, 4048358332291445128, 8698391063771309319, 2695137655403156913,
     4372455370986538303, 7421500513476654443, 5859110935080353657, 5025680992567356816,
     8543552385847448680, 1803520335199100883, 4959036280836322756, 1965705342259472736,
     7948321296347221787, 4084004104374339719, 5038007832114163249, 9163675750679689972,
     277301767569582555,  2961133119750181631, 4787371142364008723, 6662748347733843021,
     4370411083041488302, 4625334424898457015, 1143416531761664019, 2618672187882556260,
     192435661912868585,  3599779823165032619, 5752629491805303920, 3238232766398894918,
     1996462209389268519, 500036277741932451,  3007712508935894331, 7580155302270232291,
     4429002033388238612, 3037335073139076600, 6974187164613943954, 9152827645805567610,
     5337588208373865471, 3127376185625271655, 4982433416607770489, 6944601625184833678,
     944868861882192898,  1102968982267570960, 6886494583362046789, 1951705072425438205,
     2440066580437441059, 6694054793105003972, 2892081337439249976, 8732793365878812277,
     6368754447981065865, 7314084505429992820, 3023467788328740531, 6240795780098439515,
     2574958111375257633, 5618688697835876037, 5890848308819214222, 3508888569648891389,
     4660927704103475340, 4309843487534128131, 8953059302730411875, 1983635002212318525,
     8713289905831969697, 7617532939981379812, 4505155819130490792, 479710538241672997,
     450338634313753543,  5770107805997014860, 5813963119050190985, 2611490380342840621,
     2932331482404581226, 6722940725848668228, 2346725331784842053, 6435524918627975816,
     5620314812706729806, 108331243201836963,  7783544931414378124, 7519755929190410295,
     1546284006024185826, 432089972100723718,  3817499060172687477, 7701978055411457468,
     8705595554014062533, 7741644114981451447, 7036245378089342384, 4461735834075117816,
     136569501940940758,  345012571565716498,  2969761777416826750, 267575832759324396,
     8302533863795987750, 4716706636146113918, 2467873323522800496, 4912797526187353567,
     8927007358651279058, 842225113551919836,  6256688008630474000, 7788972078603115396,
     3569544963104748961, 1811726131586913572, 7437006615199307295, 2127623123683496043,
     8234766486583557978, 833498911863771408,  29801146440645399,   1347860780414389669,
     1476981822731740812, 5971669736032414703, 9077657945042251994, 7959012469359076686,
     7005982721505586099, 3079055614100653811, 8122068717167081667, 554838186511236506,
     7951899806136333490, 3850659943461403061, 8640026281612697819, 4515738464766337222,
     8450918760246627997, 409204917337345806,  6450312123400688083, 7589682884364098034,
     7821633118607206359, 2648777049089743451, 5999075806759245744, 7233840256778661981,
     962283029797748691,  7820985182543856679, 2734179485578566088, 2329221355674593018,
     1519015648150983808, 7628241641488472396, 2934792329426119375, 8587090619955418513,
     8269845450325109737, 1419686924797952801, 1529989204632174930, 4200707446148675099,
     4123978351554044660, 7804169313179288027, 8233901976832462879, 4681368612868570632,
     6904161369275197834, 9057164714592782473, 2431433092905452529, 1877676075006595533,
     8342895332548595763, 4886118636112825804, 3203153749040325933, 4216654675790427247,
     4022760721798940668, 7746412701529165523, 5422339372895655075, 5681000212815721081,
     349860562764256613,  1222627811200922172, 853062987536115341,  8556575509372155255,
     9182978184774627956, 8172193176957784938, 1330010183667985797, 6341487979734257366,
     1109042890454929489, 2503849102334261435, 6254071802500743168, 6561823806300882581,
     3133473346153260219, 6606210416023507275, 7808612577503369814, 8878758408791322871,
     7325636078977202201, 7518863645157053760, 6782010609354445688, 6712551388617338558,
     6019063274372270264, 9132655993804635217, 6487869739534985055, 7798606939549545462,
     8255006519971391433, 2685737234777877807, 7799587785301203420, 6339166773062266822,
     5109053475199256876, 1042129778941310967, 6785843742067967190, 2629395123555668798,
     1575530336162810913, 3843434811701451669, 7776953853827347254, 5875785663789294981,
     6993986687889394811, 2698346512530321964, 2812469527010946301, 2632024983704742796,
     2352665415959155411, 7129810295744920720, 5341951224854088832, 2638570261152754504,
     7967610182035926376, 4921926685488871727, 4378216193119407149, 1194817632437251885,
     8476208540902487276, 5087915437944698856, 6370866609750201622, 2379063410217640977,
     7525398692060823364, 8399965651354424684, 6350991333678087263, 2958600188049588488,
     7126380820981979572, 409165883630500834,  5110643476744661487, 4472592674327346144,
     6728436187024804457, 161591470172670357,  7722469129858498942, 7837026868276686565,
     6394661553191076741, 4781723959221460621, 5441899340688278586, 7683637386871323180,
     3014825257479772379, 4858422175963836352, 8668849599575363729, 8846101308235293804,
     8682060813100641889, 593446355829084281,  3079631301941757817, 8424213877063823272,
     5237186355265356138, 2467975793253738617, 718842415139123712,  1488217047467997522,
     4783200896189742635, 1432288057561927200, 4207356341421267581, 4745654193770087908,
     6752784408949446630, 7364626151056640146, 8197726696892573293, 3546748320665309885,
     7019250579595660622, 3002375684979223839, 9206233708798308240, 1460205292499461802,
     1565650837717472774, 8956331475477967842, 5009811710428849794, 174625184332021132,
     7491117494928131348, 1571368769787062036, 1499466645177455609, 473911361540887274,
     6697727296436298397, 5227140995384611927, 5602520904622360700, 4105125388462792152,
     3690711955689540170, 4273909292045888145, 87346561775511488,   8893621654841961173,
     438923633443774560,  3937490650202097100, 624385544849050605,  6018375911488957328,
     5719029074280582917, 1367232806711996563, 4683395610125877149, 6247374741025132254,
     456309648290602747,  7829832819739044676, 1801660974455147081, 233857959126465857,
     595715203639333908,  9165946555630276206, 1018509798862928142, 2336059162760346010,
     8239405230227838972, 6906168776179327057, 1162293610641785535, 7755921780146779370,
     2067545297382235782, 4876446371820598467, 1740926722551851260, 8908691770773061725,
     4151592771250955990, 8256066921607933806, 1003366686002132157, 2222254641143498162,
     3774320095051977857, 2282143655056311462, 1777653296681684325, 6250263326221608702,
     1668380591776841128, 434105226129377610,  7634232712064701233, 488624854781186604,
     8089809560575124402, 7229346875805306842, 7265520296150289040, 2804600614967170213,
     5206447124378663896, 8146994774105088645, 1103848339304984770, 7808895700022262119,
     3310706538312809560, 447626289269609172,  5485870133892971599, 5882046322901757726,
     1407577642035118370, 761552897676114526,  5282806520600000157, 296844289837205002,
     6615248972616635257, 4756608288445064958, 5217485740658812443, 6851138262458617711,
     175132359835336631,  7410374640710980232, 6920638378102741548, 6157149135644767677,
     6863565619954780670, 6096332712407785538, 4079293005698302564, 1056942412250464324,
     9071158543190935497, 5305308969273432025, 3068673058088912685, 56465034401732789,
     3904972390045856711, 5117947223615436976, 3150910189404257111, 1099646928475044821,
     8520474444633242132, 4605023254822366087, 5282547838357199437, 7225713663294499524,
     8143575778526734806, 6048805140597664408, 6853681333007309415, 8486367401546133440,
     8924242860627223935, 2608688833719820438, 947085554073167228,  3230093871417165650,
     7478227190968350975, 4751144046558851877, 1870382503102138402, 4731807897052393316,
     5137440503070178648, 7385225698909296246, 1652259462189890608, 4119357728177290225,
     262869629489237057,  3571959957674562113, 8050538386915791206, 4594646771427690712,
     7403259654183225755, 1297581055694824337, 645117434266804921,  3979031117668124763,
     3652343987437300454, 305737936193179662,  5357594098111130235, 6690211403567527230,
     5151004941823105630, 2468278871046619001, 1016260362706226414, 7375727612169813141,
     7532427431144088051, 8395680956839493591, 4559270853208035545, 4887630950743599678,
     1746919257557660189, 1866131641938102668, 1489514896695638195, 1292009284499812495,
     5351965886978428265, 1441213333522634401, 6635293047496114192, 2757850514708799416,
     3760117772299884435, 142818319622664445,  2590393948124551835, 6055508125054090673,
     19489427927301225,   7259043121471483880, 8994772738598700600, 7317918751671822263,
     9108514041798731766, 3910356657568501036, 5805841116361376555, 6516515783625049154,
     6800113156318854746, 3420622912572328057, 6865781823825520322, 6774960119424637145,
     2181230778329253730, 6178905692129256150, 5212952333985003368, 5671074071015153291,
     8238858825367379472, 587830012635316500,  6630047193139652762, 305207456000564381,
     7866427123209771535, 7889846101870686521, 194558012340152198,  6383331167053917647,
     3917346935376318558, 1983333296616940618, 6759055467905113721, 2962284279470208373,
     6452699816086619897, 4488538940128364504, 2928859708630808787, 7674721879424119348,
     4642986125625636055, 731233993842391851,  6944928617364315156, 8564850484289089025,
     5252005556969570706, 813507867433423709,  3190942363238667445, 3217862698966470392,
     7777421077258811252, 8668046016667081779, 4736117372622729318, 5030018719836224456,
     2324776187584752115, 4407725262923937218, 1231426593103587844, 7197982399801424297,
     1898254960697940798, 7924074002787220556, 8965657839191805085, 5207795247074274677,
     5273504964819241351, 1217482887466579784, 3994770112140263935, 6349364589818118991,
     413169540866718083,  7861923660853448545, 8200996828912939306, 7114732061049053514}};
  // Compute zobrish hash.
  glm::ivec2 pos  = first();
  size_t     hash = 2341864530125133931;
  while (pos != last()) {
    hash ^= sZobristTable[pieceIndex(piece(pos)) * 64 + (pos.y * 8 + pos.x)];
    pos = next(pos);
  }
  return hash;
}

}  // namespace potato
